<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="How to use our statistics collection tools to enhance query optimization.">
<meta name="keywords" content=" statistics, collect statistics">
<title>Using Splice Machine Statistics | Splice Machine Documentation</title>
<meta class="swiftype" name="title" data-type="string" content="Using Splice Machine Statistics">
<meta class="swiftype" name="info" data-type="string" content="How to use our statistics collection tools to enhance query optimization.">
<meta class="swiftype" name="buildversion" data-type="enum" content="2.7.0">

<link rel="stylesheet" href="css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<link rel="stylesheet" href="css/modern-business.css">
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<!--<link rel="stylesheet" href="css/lavish-bootstrap.css"> -->
<!--<link rel="stylesheet" href="css/customstyles.css"> -->
<link rel="stylesheet" href="css/splicemain.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://localhost:4000/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container-fluid topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Splice Machine Internal Docs</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->
                
                    
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                   
                      <li class="dropdown">
                          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Splice Machine<b class="caret"></b></a>
                          <ul class="dropdown-menu">
                             
                                
                                   <li><a href="index.html">Welcome</a></li>
                               
                             
                                
                                   <li><a href="tutorials_intro.html">Tutorials</a></li>
                               
                             
                                
                                   <li><a href="sqlref_intro.html">SQL Reference Manual</a></li>
                               
                             
                                
                                   <li><a href="developers_intro.html">Developer's Manual</a></li>
                               
                             
                                
                                   <li><a href="cmdlineref_intro.html">Command Line Reference</a></li>
                               
                             
                                
                                   <li><a href="dbconsole_intro.html">Database Console</a></li>
                               
                             
                                
                                   <li><a href="notes_intro.html">General Information</a></li>
                               
                             
                          </ul>
                      </li>
                   
                      <li class="dropdown">
                          <a href="#" class="dropdown-toggle" data-toggle="dropdown">DB-Service Only<b class="caret"></b></a>
                          <ul class="dropdown-menu">
                             
                                
                                   <li><a href="dbaas_intro.html">Welcome!</a></li>
                               
                             
                                
                                   <li><a href="dbaas_cm_intro.html">Cloud Manager Guide</a></li>
                               
                             
                                
                                   <li><a href="dbaas_zep_intro.html">Using Zeppelin</a></li>
                               
                             
                                
                                   <li><a href="dbaas_info_intro.html">Release Information</a></li>
                               
                             
                          </ul>
                      </li>
                   
                      <li class="dropdown">
                          <a href="#" class="dropdown-toggle" data-toggle="dropdown">On-Premise-DB Only<b class="caret"></b></a>
                          <ul class="dropdown-menu">
                             
                                
                                   <li><a href="onprem_intro.html">Welcome!</a></li>
                               
                             
                                
                                   <li><a href="onprem_install_intro.html">Installation</a></li>
                               
                             
                                
                                   <li><a href="onprem_admin_intro.html">Administrator's Guide</a></li>
                               
                             
                                
                                   <li><a href="onprem_info_intro.html">Release Information</a></li>
                               
                             
                          </ul>
                      </li>
                   
                
                <li>
<!-- Start Swiftype search -->
                    <div id="swiftype-search-container">
                        <form>
                          <input type="text" class="st-default-search-input swiftype-input">
                          <button type="submit" class="swiftype-submit">Search</button>
                        </form>
                    </div>
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container-fluid">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">Splice Machine Internal v2.7.0</li>
    
    
    
    <li>
        <a href="#">Developer's Guide</a>
        <ul>
            
            
            
            <li><a href="developers_intro.html">Introduction</a></li>
            
            
            
            
        </ul>
     </li>
       
        
    
    <li>
        <a href="#">Fundamentals</a>
        <ul>
            
            
            
            <li><a href="developers_fundamentals_intro.html">Introduction</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_transactions.html">Running Transactions</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_dates.html">Working with Date and Time Values</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_triggers.html">Using Database Triggers</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_foreignkeys.html">Using Foreign Keys</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_windowfcns.html">Using Window Functions</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_temptables.html">Using Temporary Tables</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_auth.html">Roles and Authorization</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_sparklibs.html">Using Spark Libraries</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_vti.html">Using the Virtual Table Interface</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_externaltables.html">Using External Tables</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_hcatalog.html">Using HCatalog</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_mapreduce.html">Using the MapReduce API</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_hbase.html">Working with HBase</a></li>
            
            
            
            
        </ul>
     </li>
       
        
    
    <li>
        <a href="#">Functions and Stored Procedures</a>
        <ul>
            
            
            
            <li><a href="developers_fcnsandprocs_intro.html">Introduction</a></li>
            
            
            
            
            
            
            <li><a href="developers_fcnsandprocs_writing.html">Writing Functions and Stored Procedures</a></li>
            
            
            
            
            
            
            <li><a href="developers_fcnsandprocs_storing.html">Storing/Updating Functions and Procs</a></li>
            
            
            
            
            
            
            <li><a href="developers_fcnsandprocs_examples.html">Examples</a></li>
            
            
            
            
        </ul>
     </li>
       
        
    
    <li>
        <a href="#">Ingesting and Streaming Data</a>
        <ul>
            
            
            
            <li><a href="tutorials_ingest_intro.html">Introduction</a></li>
            
            
            
            
            
            
            <li><a href="tutorials_ingest_uploadtos3.html">Uploading Data to an S3 Bucket</a></li>
            
            
            
            
            
            
            <li><a href="tutorials_ingest_configures3.html">Configuring an S3 Bucket</a></li>
            
            
            
            
            
            
            <li><a href="tutorials_ingest_tpch1.html">Importing TPCH Data</a></li>
            
            
            
            
            
            
            <li><a href="tutorials_ingest_importing.html">Importing Your Data</a></li>
            
            
            
            
            
            
            <li><a href="tutorials_ingest_hfiles.html">Importing Data as HFiles</a></li>
            
            
            
            
            
            
            <li><a href="tutorials_ingest_kafkaproducer.html">Kafka - Creating a Producer</a></li>
            
            
            
            
            
            
            <li><a href="tutorials_ingest_kafkafeed.html">Kafka - Configuring a Feed</a></li>
            
            
            
            
            
            
            <li><a href="tutorials_ingest_mqttSpark.html">MQTT Spark Streaming</a></li>
            
            
            
            
            
            
            <li><a href="tutorials_ingest_storm.html">Apache Storm and Splice Machine</a></li>
            
            
            
            
        </ul>
     </li>
       
        
    
    <li>
        <a href="#">Analytics and Machine Learning</a>
        <ul>
            
            
            
            <li><a href="tutorials_ml_intro.html">Introduction</a></li>
            
            
            
            
            
            
            <li><a href="tutorials_ml_zeppelin.html">Using Apache Zeppelin</a></li>
            
            
            
            
        </ul>
     </li>
       
        
    
    <li>
        <a href="#">Tuning and Debugging</a>
        <ul>
            
            
            
            <li><a href="developers_tuning_intro.html">Introduction</a></li>
            
            
            
            
            
            
            <li><a href="developers_tuning_queryoptimization.html">Optimizing Queries</a></li>
            
            
            
            
            
            
            <li class="active"><a href="developers_tuning_usingstats.html">Using Statistics</a></li>
            
            
            
            
            
            
            <li><a href="developers_tuning_explainplan.html">Using Explain Plan</a></li>
            
            
            
            
            
            
            <li><a href="developers_tuning_explainplan_examples.html">Explain Plan Examples</a></li>
            
            
            
            
            
            
            <li><a href="developers_tuning_logging.html">Logging</a></li>
            
            
            
            
            
            
            <li><a href="developers_tuning_debugging.html">Debugging</a></li>
            
            
            
            
            
            
            <li><a href="developers_tuning_snapshots.html">Using Snapshots</a></li>
            
            
            
            
        </ul>
     </li>
       
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            

<div class="post-content">

<!--- Don't automatically put page summary at top - GRH 05/2017:
   
    <div class="summary">How to use our statistics collection tools to enhance query optimization.</div>
   
-->

    


    

  <section>
<div class="TopicContent" data-swiftype-index="true">
    <h1 id="using-statistics-with-splice-machine">Using Statistics with Splice Machine</h1>

    <p>This topic introduces how to use database statistics with Splice
Machine. Database statistics are a form of metadata (data about data)
that assists the Splice Machine query optimizer; the statistics help the
optimizer select the most efficient approach to running a query, based
on information that has been gathered about the tables involved in the
query.</p>

    <p>This topic describes how to:</p>

    <ul>
      <li><a href="#Collecti">Collecting statistics</a> for a schema or table in your
database</li>
      <li><a href="#Dropping">Dropping statistics</a> for a schema</li>
      <li><a href="#Enabling">Enable and disable collection of statistics</a> on specific
columns in tables in your database</li>
      <li><a href="#Viewing">View collected statistics</a></li>
    </ul>

    <p>Statistics are inexact; in fact, some statistics like table cardinality
are estimated using advanced algorithms, due to the resources required
to compute these values. It’s important to keep this in mind when basing
design decisions on values in database statistics tables.</p>

    <p class="noteImportant">It’s also important to note that the statistics for your database are
not automatically refreshed when the data in your database changes,
which means that when you query a statistical table or view, the results
you see may not exactly match the data in the actual tables.</p>

    <h2 id="Collecti">Collecting Statistics</h2>

    <p>You can collect statistics on a schema or table using the <a href="cmdlineref_analyze.html"><span class="AppFontCustCode">splice&gt; Analyze</span></a>
command.</p>

    <p>You can also use the
<a href="sqlref_sysprocs_collectschemastats.html"><code>SYSCS_UTIL.COLLECT_SCHEMA_STATISTICS</code></a>
procedure to collect statistics on an entire schema, including every
table in the schema. For example:</p>

    <div class="preWrapperWide">

      <pre class="Example"><code>splice&gt; CALL SYSCS_UTIL.COLLECT_SCHEMA_STATISTICS( 'SPLICEBBALL', false );
</code></pre>

    </div>
    <p class="spaceAbove">During statistical collection:</p>

    <ul>
      <li>Statistics are automatically collected on columns in a primary key,
and on columns that are indexed. These are called <em>keyed columns</em>.</li>
      <li>Statistics are also collected on columns for which you have enabled
statistics collection, as described in the next section, <a href="#Enabling">Enabling and
Disabling Statistics.</a></li>
    </ul>

    <p>Once collection of statistics has completed, the Splice Machine query
optimizer will automatically begin using the updated statistics to
optimize query execution plans.</p>

    <h3 id="when-should-you-collect-statistics">When Should You Collect Statistics?</h3>

    <p>We advise that you collect statistics after you have:</p>

    <ul>
      <li>Created an index on a table.</li>
      <li>Modified a significant number of rows in a table with update, insert,
or delete operations.</li>
    </ul>

    <p class="noteIndent">A general rule-of-thumb is that you should collect statistics after
modifying more than 10% of data.</p>

    <h3 id="on-which-columns-should-you-collect-statistics">On Which Columns Should You Collect Statistics?</h3>

    <p>By default, Splice Machine collects statistics on all columns in a
table.</p>

    <p>To reduce the operational cost of analyzing large tables (such as fact
tables), you can tell Splice Machine to not collect statistics on
certain columns by running the
<a href="sqlref_sysprocs_disablecolumnstats.html"><code>SYSCS_UTIL.DISABLE_COLUMN_STATISTICS</code></a> built-in
system procedure:</p>

    <div class="fcnWrapperWide">
      <pre class="FcnSyntax" style="text-indent: 0.5in;"><code>SYSCS_UTIL.DISABLE_COLUMN_STATISTICS( schema, table, column);
</code></pre>

    </div>
    <p>Splice Machine strongly recommends that you <em>always</em> collect statistics
on small tables, such as a table that has hundreds of rows on each
region server.</p>

    <h3 id="how-to-determine-if-you-should-collect-or-drop-statistics">How to Determine if You Should Collect or Drop Statistics</h3>

    <p>You can use <a href="developers_tuning_explainplan.html">Explain Plan</a> in your
development or test environment to determine how dropping or collecting
statistics changes the execution plan for a query.</p>

    <h2 id="Dropping">Dropping Statistics</h2>

    <p>If you subsequently wish to drop statistics for a schema, you can use
the
<a href="sqlref_sysprocs_dropschemastats.html"><code>SYSCS_UTIL.DROP_SCHEMA_STATISTICS</code></a>
procedure to drop statistics for an entire schema. For example:</p>

    <div class="preWrapperWide">
      <pre class="Example"><code>splice&gt; CALL SYSCS_UTIL.DROP_SCHEMA_STATISTICS('SPLICEBBALL');
</code></pre>

    </div>
    <h2 id="Enabling">Enabling and Disabling Statistics on Specific Columns</h2>

    <p>When you collect statistics, Splice Machine automatically collects
statistics on keyed columns, which are columns in a primary key and
columns that are indexed.</p>

    <p class="noteTip">Please review the recommendations and restrictions regarding which
columns should or should not have statistics collection enabled, as
noted below in the <a href="#Selectin">Selecting Columns for Statistics
Collection</a> subsection.</p>

    <p>You can also explicitly enable statistics collection on specific columns
in tables using the
<a href="sqlref_sysprocs_enablecolumnstats.html"><code>SYSCS_UTIL.ENABLE_COLUMN_STATISTICS</code></a>
procedure. For example:</p>

    <div class="preWrapperWide">

      <pre class="Example"><code>CALL SYSCS_UTIL.ENABLE_COLUMN_STATISTICS('SPLICEBBALL', 'Players', 'Birthdate');
</code></pre>

    </div>
    <h4 id="disabling-statistics-collection-on-a-column">Disabling Statistics Collection on a Column</h4>

    <p class="spaceAbove">If you subsequently wish to disable collection of statistics on a
specific column in a table, use the
<a href="sqlref_sysprocs_disablecolumnstats.html"><code>SYSCS_UTIL.DISABLE_COLUMN_STATISTICS</code></a>
procedure:</p>

    <div class="preWrapperWide">

      <pre class="Example"><code>splice&gt; CALL SYSCS_UTIL.DISABLE_COLUMN_STATISTICS('SPLICEBBALL', 'Players', 'Birthdate');
</code></pre>

    </div>
    <p>Once you’ve enabled or disabled statistics collection for one or more
table columns, you should update the query optimizer by <a href="#Collecti">collecting
statistics</a> on the table or schema.</p>

    <h3 id="Selectin">Selecting Columns for Statistics Collection</h3>

    <p>You can only collect statistics on columns containing data that can be
ordered. This includes all numeric types, Boolean values, some
<code>CHAR</code> and <code>BIT</code> data types, and date and timestamp values.</p>

    <p>When selecting columns on which statistics should be collected, keep
these ideas in mind:</p>

    <ul>
      <li>The process of collecting statistics requires both memory and compute
time to complete; the more statistics you collect, the longer it takes
and the more of your computing resources that it uses.</li>
      <li>You <em>should collect statistics</em> for any column that is used as a
predicate in a query.</li>
      <li>You <em>should collect statistics</em> for any column that is used in a
<code>select distinct</code>, <code>Group by</code>, <code>order by</code>, or <code>join</code> clause.</li>
      <li>You <em>do not need to enable statistics</em> for columns that are merely
carried through the computation; however, doing so may improve heap
size estimations, which in turn can make broadcast joins more likely
to be chosen.</li>
    </ul>

    <p>As you can see, selecting columns for statistics is a tradeoff between
the resources required to collect the statistics, and the improvements
in optimization that result from having the statistics collected.</p>

    <h2 id="Viewing">Viewing Collected Statistics</h2>

    <p>Splice Machine provides two system tables you can query to view the
statistics that have been collected for your database:</p>

    <ul>
      <li>Query the  <a href="sqlref_systables_systablestats.html"><code>SYSTABLESTATISTICS System
Table</code></a> to view statistics for
specific tables</li>
      <li>Query the  <a href="sqlref_systables_syscolumnstats.html"><code>SYSCOLUMNSTATISTICS System
Table</code></a> to view statistics for
specific table columns</li>
    </ul>

    <h2 id="see-also">See Also</h2>

    <ul>
      <li><a href="sqlref_datatypes_compatability.html">Splice Machine Data Assignments and
Comparisons</a></li>
      <li><a href="sqlref_sysprocs_collectschemastats.html"><code>SYSCS_UTIL.COLLECT_SCHEMA_STATISTICS</code></a></li>
      <li><a href="sqlref_sysprocs_disablecolumnstats.html"><code>SYSCS_UTIL.DISABLE_COLUMN_STATISTICS</code></a></li>
      <li><a href="sqlref_sysprocs_dropschemastats.html"><code>SYSCS_UTIL.DROP_SCHEMA_STATISTICS</code></a></li>
      <li><a href="sqlref_sysprocs_enablecolumnstats.html"><code>SYSCS_UTIL.ENABLE_COLUMN_STATISTICS</code></a></li>
      <li><a href="sqlref_systables_syscolumnstats.html"><code>SYSCOLUMNSTATISTICS System Table</code></a></li>
      <li><a href="sqlref_systables_systablestats.html"><code>SYSTABLESTATISTICS System Table</code></a></li>
    </ul>

  </div>
</section>


    <div class="tags">
        
    </div>



</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2017 Splice Machine, Inc. All rights reserved. <br />
 Site last generated: Nov 20, 2017 <br />
<p><img src="images/company_logo.png" alt="Company logo"/></p>
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>

        <!-- Swiftype script; values depend on which built type and which build version -->

<script type="text/javascript">
(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

_st('install','YGtH3zGt4NJzs35yCo5A','2.0.0', {
  install: {
    hooks: {
      query_filter: function(query) {
        query.setFilterDataByDocumentTypeSlugAndFilterField('page', 'buildversion', { values: ['2.7.0'], type: "and" });

        return query;
      }
    }
  }
});
</script>


</body>
    <!-- Only include analytics scripts if generating the customer docs -->


</html>
