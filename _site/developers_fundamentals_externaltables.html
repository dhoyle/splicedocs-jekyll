<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="How to use external tables with Splice Machine">
<meta name="keywords" content=" external tables, orc format, parquet, textfile, external file, compression">
<title>Using External Tables | Splice Machine Documentation</title>
<meta class="swiftype" name="title" data-type="string" content="Using External Tables">
<meta class="swiftype" name="info" data-type="string" content="How to use external tables with Splice Machine">
<meta class="swiftype" name="buildversion" data-type="enum" content="2.7.0">

<link rel="stylesheet" href="css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<link rel="stylesheet" href="css/modern-business.css">
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<!--<link rel="stylesheet" href="css/lavish-bootstrap.css"> -->
<!--<link rel="stylesheet" href="css/customstyles.css"> -->
<link rel="stylesheet" href="css/splicemain.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://localhost:4000/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container-fluid topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Splice Machine Internal Docs</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->
                
                    
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                   
                      <li class="dropdown">
                          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Splice Machine<b class="caret"></b></a>
                          <ul class="dropdown-menu">
                             
                                
                                   <li><a href="index.html">Welcome</a></li>
                               
                             
                                
                                   <li><a href="tutorials_intro.html">Tutorials</a></li>
                               
                             
                                
                                   <li><a href="sqlref_intro.html">SQL Reference Manual</a></li>
                               
                             
                                
                                   <li><a href="developers_intro.html">Developer's Manual</a></li>
                               
                             
                                
                                   <li><a href="cmdlineref_intro.html">Command Line Reference</a></li>
                               
                             
                                
                                   <li><a href="dbconsole_intro.html">Database Console</a></li>
                               
                             
                                
                                   <li><a href="notes_intro.html">General Information</a></li>
                               
                             
                          </ul>
                      </li>
                   
                      <li class="dropdown">
                          <a href="#" class="dropdown-toggle" data-toggle="dropdown">DB-Service Only<b class="caret"></b></a>
                          <ul class="dropdown-menu">
                             
                                
                                   <li><a href="dbaas_intro.html">Welcome!</a></li>
                               
                             
                                
                                   <li><a href="dbaas_cm_intro.html">Cloud Manager Guide</a></li>
                               
                             
                                
                                   <li><a href="dbaas_zep_intro.html">Using Zeppelin</a></li>
                               
                             
                                
                                   <li><a href="dbaas_info_troubleshoot.html">Troubleshooting/Best Practices</a></li>
                               
                             
                                
                                   <li><a href="dbaas_info_intro.html">Release Information</a></li>
                               
                             
                          </ul>
                      </li>
                   
                      <li class="dropdown">
                          <a href="#" class="dropdown-toggle" data-toggle="dropdown">On-Premise-DB Only<b class="caret"></b></a>
                          <ul class="dropdown-menu">
                             
                                
                                   <li><a href="onprem_intro.html">Welcome!</a></li>
                               
                             
                                
                                   <li><a href="onprem_install_intro.html">Installation</a></li>
                               
                             
                                
                                   <li><a href="onprem_admin_intro.html">Administrator's Guide</a></li>
                               
                             
                                
                                   <li><a href="onprem_info_troubleshoot.html">Troubleshooting/Best Practices</a></li>
                               
                             
                                
                                   <li><a href="onprem_info_intro.html">Release Information</a></li>
                               
                             
                          </ul>
                      </li>
                   
                

                <!-- If building the docsdev version, do not include Swiftype search box -->
                
                <li>
<!-- Start Swiftype search -->
                    <div id="swiftype-search-container">
                        <form>
                          <input type="text" class="st-default-search-input swiftype-input">
                          <button type="submit" class="swiftype-submit">Search</button>
                        </form>
                    </div>
                </li>
                
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container-fluid">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">Splice Machine Internal v2.7.0</li>
    
    
    
    <li>
        <a href="#">Developer's Guide</a>
        <ul>
            
            
            
            <li><a href="developers_intro.html">Introduction</a></li>
            
            
            
            
        </ul>
     </li>
       
        
    
    <li>
        <a href="#">Fundamentals</a>
        <ul>
            
            
            
            <li><a href="developers_fundamentals_intro.html">Introduction</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_transactions.html">Running Transactions</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_dates.html">Working with Date and Time Values</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_triggers.html">Using Database Triggers</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_foreignkeys.html">Using Foreign Keys</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_windowfcns.html">Using Window Functions</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_temptables.html">Using Temporary Tables</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_auth.html">Roles and Authorization</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_sparklibs.html">Using Spark Libraries</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_vti.html">Using the Virtual Table Interface</a></li>
            
            
            
            
            
            
            <li class="active"><a href="developers_fundamentals_externaltables.html">Using External Tables</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_hcatalog.html">Using HCatalog</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_mapreduce.html">Using the MapReduce API</a></li>
            
            
            
            
            
            
            <li><a href="developers_fundamentals_hbase.html">Working with HBase</a></li>
            
            
            
            
        </ul>
     </li>
       
        
    
    <li>
        <a href="#">Functions and Stored Procedures</a>
        <ul>
            
            
            
            <li><a href="developers_fcnsandprocs_intro.html">Introduction</a></li>
            
            
            
            
            
            
            <li><a href="developers_fcnsandprocs_writing.html">Writing Functions and Stored Procedures</a></li>
            
            
            
            
            
            
            <li><a href="developers_fcnsandprocs_storing.html">Storing/Updating Functions and Procs</a></li>
            
            
            
            
            
            
            <li><a href="developers_fcnsandprocs_examples.html">Examples</a></li>
            
            
            
            
        </ul>
     </li>
       
        
    
    <li>
        <a href="#">Ingesting and Streaming Data</a>
        <ul>
            
            
            
            <li><a href="tutorials_ingest_intro.html">Introduction</a></li>
            
            
            
            
            
            
            <li><a href="tutorials_ingest_uploadtos3.html">Uploading Data to an S3 Bucket</a></li>
            
            
            
            
            
            
            <li><a href="tutorials_ingest_configures3.html">Configuring an S3 Bucket</a></li>
            
            
            
            
            
            
            <li><a href="tutorials_ingest_importoverview.html">Importing Data Tutorial</a></li>
            
            
            
            
            
            
            <li><a href="tutorials_ingest_kafkaproducer.html">Kafka - Creating a Producer</a></li>
            
            
            
            
            
            
            <li><a href="tutorials_ingest_kafkafeed.html">Kafka - Configuring a Feed</a></li>
            
            
            
            
            
            
            <li><a href="tutorials_ingest_mqttSpark.html">MQTT Spark Streaming</a></li>
            
            
            
            
            
            
            <li><a href="tutorials_ingest_storm.html">Apache Storm and Splice Machine</a></li>
            
            
            
            
        </ul>
     </li>
       
        
    
    <li>
        <a href="#">Analytics and Machine Learning</a>
        <ul>
            
            
            
            <li><a href="tutorials_ml_intro.html">Introduction</a></li>
            
            
            
            
            
            
            <li><a href="tutorials_ml_zeppelin.html">Using Apache Zeppelin</a></li>
            
            
            
            
        </ul>
     </li>
       
        
    
    <li>
        <a href="#">Tuning and Debugging</a>
        <ul>
            
            
            
            <li><a href="developers_tuning_intro.html">Introduction</a></li>
            
            
            
            
            
            
            <li><a href="developers_tuning_queryoptimization.html">Optimizing Queries</a></li>
            
            
            
            
            
            
            <li><a href="developers_tuning_usingstats.html">Using Statistics</a></li>
            
            
            
            
            
            
            <li><a href="developers_tuning_explainplan.html">Using Explain Plan</a></li>
            
            
            
            
            
            
            <li><a href="developers_tuning_explainplan_examples.html">Explain Plan Examples</a></li>
            
            
            
            
            
            
            <li><a href="developers_tuning_logging.html">Logging</a></li>
            
            
            
            
            
            
            <li><a href="developers_tuning_debugging.html">Debugging</a></li>
            
            
            
            
            
            
            <li><a href="developers_tuning_snapshots.html">Using Snapshots</a></li>
            
            
            
            
        </ul>
     </li>
       
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            

<div class="post-content">

<!--- Don't automatically put page summary at top - GRH 05/2017:
   
    <div class="summary">How to use external tables with Splice Machine</div>
   
-->

    


    

  <section>
<div class="TopicContent" data-swiftype-index="true">
    <h1 id="using-the-splice-machine-external-table-feature">Using the Splice Machine External Table Feature</h1>

    <p>This topic covers the use of external tables in Splice Machine. An
external table references a file stored in a flat file format. You can
use flat files that are stored in one of these formats:</p>

    <ul>
      <li><code>ORC</code> is a columnar storage format</li>
      <li><code>PARQUET</code> is a columnar storage format</li>
      <li><code>Avro</code> is a data serialization system</li>
      <li><code>TEXTFILE</code> is a plain text file</li>
    </ul>

    <p>You can access <code>ORC</code> and <code>PARQUET</code> files that have been compressed with
either Snappy or ZLIb compression; however, you cannot use a compressed
plain text file.</p>

    <h2 id="about-external-tables">About External Tables</h2>

    <p>You can use Splice Machine external tables to query the contents of flat
files that are stored outside of your database. You query external
tables pretty much the same way as you do the tables in your database.</p>

    <p>External tables reference files that are stored in a flat file format
such as Apache Parquet or Apache Orc, both of which are columnar storage
formats that are available in Hadoop. You can use the  <a href="sqlref_statements_createexternaltable.html"><code>CREATE EXTERNAL
TABLE</code></a> statement to create
an external table that is connected to a specific flat file.</p>

    <h2 id="using-external-tables">Using External Tables</h2>

    <p>This section presents information about importing data into an external
table, and includes several examples of using external tables with
Splice Machine.</p>

    <h3 id="importing-data-into-an-external-table">Importing Data Into an External Table</h3>

    <p>You cannot import data directly into an external table; if you already
have an external table in a compatible format, you can use  <a href="sqlref_statements_createexternaltable.html"><code>CREATE
EXTERNAL TABLE</code></a> statement
to point at the external file and query against it.</p>

    <p>If you want to create an external file from within Splice Machine,
follow these steps:</p>

    <ol>
      <li>Create (or use) a table in your Splice Machine database (your
internal table).</li>
      <li>Use  <a href="sqlref_statements_createexternaltable.html"><code>CREATE EXTERNAL
TABLE</code></a> to create your
empty external table, specifying the location where you want that
data stored externally.</li>
      <li>Use  <a href="sqlref_statements_insert.html"><code>INSERT INTO</code></a> (your external
table) <code>SELECT</code> (from your internal table) to populate the external
file with your data.</li>
      <li>You can now query the external table.</li>
    </ol>

    <h3 id="accessing-a-parquet-file">Accessing a Parquet File</h3>

    <p>The following statement creates an external table for querying a
<code>PARQUET</code> file that is stored on your computer:</p>

    <div class="preWrapperWide">
      <pre class="Example"><code>splice&gt; CREATE EXTERNAL TABLE myExtTbl (
  col1 INT, col2 VARCHAR(24))
    PARTITIONED BY (col1)
    STORED AS PARQUET
    LOCATION '/users/myname/myParquetFile';0 rows inserted/updated/deleted
</code></pre>

    </div>
    <p>The call to <code>CREATE EXTERNAL TABLE</code> associates a Splice Machine external
table with the file named <code>myparquetfile</code>, and tells Splice Machine
that:</p>

    <ul>
      <li>The table should be partitioned based on the values in <code>col1</code>.</li>
      <li>The file is stored in PARQUET format.</li>
      <li>The file is located in <code>/users/myname/myParquetFile</code>.</li>
    </ul>

    <p>After you create the external table, you can query <code>myExtTbl</code> just as
you would any other table in your database.</p>

    <h3 id="accessing-and-updating-an-orc-file">Accessing and Updating an ORC File</h3>

    <p>The following statement creates an external table for creates an
external table for an <code>ORC</code> file and inserts data into it:</p>

    <div class="preWrapperWide">

      <pre class="Example"><code>splice&gt; CREATE EXTERNAL TABLE myExtTbl2
  (col1 INT, col2 VARCHAR(24))
   PARTITIONED BY (col1)
   STORED AS ORC
   LOCATION '/users/myname/myOrcFile';
0 rows inserted/updated/deleted
splice&gt; INSERT INTO myExtTbl2 VALUES (1, 'One'), (2, 'Two'), (3, 'Three');
3 rows inserted/updated/deletedsplice
&gt; SELECT * FROM myExtTbl2;
COL1        |COL2
------------------------------------
3           |Three
2           |Two
1           |One
</code></pre>

    </div>
    <p>The call to <code>CREATE EXTERNAL TABLE</code> associates a Splice Machine external
table with the file named <code>myOrcFile</code>, and tells Splice Machine that:</p>

    <ul>
      <li>The table should be partitioned based on the values in <code>col1</code>.</li>
      <li>The file is stored in ORC format.</li>
      <li>The file is located in <code>/users/myname/myOrcFile</code>.</li>
    </ul>

    <p>The call to <code>INSERT INTO </code> demonstrates that you can insert values into
the external table just as you would with an ordinary table.</p>

    <h3 id="accessing-a-plain-text-file">Accessing a Plain Text File</h3>

    <p class="body">You can specify a table constraint on an external table; for example:</p>

    <div class="preWrapperWide">

      <pre class="Example"><code>splice&gt; CREATE EXTERNAL TABLE myTextTable(
     col1 INT, col2 VARCHAR(24))
   PARTITIONED BY (col1)
   ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' ESCAPED BY '\\'
   LINES TERMINATED BY '\\n'
   STORED AS TEXTFILE
   LOCATION '/users/myName/myTextFile';0 rows inserted/updated/deleted
</code></pre>

    </div>
    <p>The call to <code>CREATE EXTERNAL TABLE</code> associates a Splice Machine external
table with the file named <code>myOrcFile</code>, and tells Splice Machine that:</p>

    <ul>
      <li>The table should be partitioned based on the values in <code>col1</code>.</li>
      <li>Each field in each row is terminated by a comma.</li>
      <li>Each line in the file is terminated by a line-end character.</li>
      <li>The file is stored in plain text format.</li>
      <li>The file is located in <code>/users/myName/myTextFile</code>.</li>
    </ul>

    <h3 id="accessing-a-compressed-file">Accessing a Compressed File</h3>

    <p>This example is exactly the same as our first example, except that the
source file has been compressed with Snappy compression:</p>

    <div class="preWrapperWide">
      <pre class="Example"><code>splice&gt; CREATE EXTERNAL TABLE myExtTbl (
      col1 INT, col2 VARCHAR(24))
    COMPRESSED WITH SNAPPY
    PARTITIONED BY (col1)
    STORED AS PARQUET
    LOCATION '/users/myname/myParquetFile';
 0 rows inserted/updated/deleted
</code></pre>

    </div>
    <h2 id="manually-refreshing-an-external-tables">Manually Refreshing an External Tables</h2>

    <p>If the schema of the file represented by an external table is updated,
Splice Machine needs to refresh its representation. When you use the
external table, Spark caches its schema in memory to improve
performance; as long as you are using Spark to modify the table, it is
smart enough to refresh the cached schema. However, if the table schema
is modified outside of Spark, you need to call the
<a href="sqlref_sysprocs_refreshexttable.html"><code>SYSCS_UTIL.SYSCS_REFRESH_EXTERNAL_TABLE</code></a>
built-in system procedure. For example:</p>

    <div class="preWrapperWide">
      <pre class="Example"><code>splice&gt; CALL SYSCS_UTIL.SYSCS_REFRESH_EXTERNAL_TABLE('APP', 'myExtTable');
Statement executed.
</code></pre>

    </div>
    <h2 id="see-also">See Also</h2>

    <p>The
<a href="sqlref_statements_createexternaltable.html"><code>CREATE EXTERNAL TABLE</code></a>
statement.</p>

    <p>The
<a href="sqlref_sysprocs_refreshexttable.html"><code>SYSCS_UTIL.SYSCS_REFRESH_EXTERNAL_TABLE</code></a>
built-in system procedure.</p>

  </div>
</section>


    <div class="tags">
        
    </div>



</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2018 Splice Machine, Inc. All rights reserved. <br />
 Site last generated: Jan 19, 2018 <br />
<p><img src="images/company_logo.png" alt="Company logo"/></p>
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>

        <!-- Swiftype script; values depend on which built type and which build version -->

<script type="text/javascript">
(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

_st('install','YGtH3zGt4NJzs35yCo5A','2.0.0', {
  install: {
    hooks: {
      query_filter: function(query) {
        query.setFilterDataByDocumentTypeSlugAndFilterField('page', 'buildversion', { values: ['2.7.0'], type: "and" });

        return query;
      }
    }
  }
});
</script>


</body>
    <!-- Only include analytics scripts if generating the customer docs -->


</html>
