#!/bin/sh

PS3="Select which Docs Version to build: "
COLUMNS=12
OPTIONS=( 'DocsDev'
          'DocsTest'
          'Doc 2.7'
          'Doc 2.5' )
select opt in "${OPTIONS[@]}"; do
    case $opt in
        'DocsDev')
            version='docsdev'
            branch='2.7'
            break;
            ;;
        'DocsTest')
            version='docstest'
            branch='2.7'
            break;
            ;;
        'Doc 2.7')
            version='doc'
            branch='2.7'
            break;
            ;;
        'Doc 2.5')
            version='doc'
            branch='2.5'
            break;
            ;;
        *) echo Invalid option;;
    esac
done

echo "  --> Building with _config.yml,_config_$version.yml,_config_$branch.yml"
echo "       - Will generate sitemap file: _site/sitemap.$branch.xml"
echo "       - Will rename sitemap index file sitemapindex.$version.xml to _site/sitemap.xml"

jekyll serve --config=_config.yml,_config_$version.yml,_config_$branch.yml

# When generating a current or test version, we:
#   a. need to move the sitemap generated by jekyll (in _site/sitemapgen.xml) to the name of the branch sitemap
#   b. need to copy the sitemap index file (links to each sitemap) to _site/sitemap.xml

mv _site/sitemapgen.xml _site/sitemap.$branch.xml
cp sitemapindex.$version.xml _site/sitemap.xml
