---
title: OVER clause
summary: A clause used in window functions to define the window on which the function operates. Window functions are permitted only in the SELECT list and the ORDER BY clause of queries.
keywords:
toc: false
product: all
sidebar:  sqlref_sidebar
permalink: sqlref_clauses_over.html
folder: SQLReference/Clauses
---
	<section>
		<div class="TopicContent">
            <h1 id="kanchor361">OVER</h1>
            <p>The <span class="CodeFont">OVER</span> clause is used in window functions to define the window on which the function operates. Window functions are permitted only in the <span class="CodeFont"><a href="sqlref_clauses_orderby.html">ORDER BY</a></span> clause of queries. </p>
            <p>For general information about and examples of Window functions in Splice Machine, see  the <a href="developers_fundamentals_windowfcns.html">Using Window Functions</a> topic in our <span class="ItalicFont">Splice Machine Developer's Guide</span>.</p>
            <p class="heading2">Syntax</p>
            <div class="fcnWrapperWide"><pre class="FcnSyntax" xml:space="preserve">expression OVER(&#160;
     [<span class="ItalicFont">partitionClause</span>]
     [<span class="ItalicFont">orderClause</span>]
     [<span class="ItalicFont">frameClause</span>] );
</pre>
            </div>
            <div class="paramList">
                <p class="paramName">expression</p>
                <p class="paramDefnFirst">Any value expression that does not itself contain window function calls.</p>
                <p class="paramName">partitionClause</p>
                <p class="paramDefnFirst">Optional. Specifies how the window function is broken down over groups, in the same way that <span class="CodeFont">GROUP&#160;BY</span>&#160;specifies groupings for regular aggregate functions. If you omit this clause, there is one partition that contains all rows.</p>
                <p class="paramDefn">The syntax for this clause is essentially the same as for the <span class="CodeFont"><a href="sqlref_clauses_groupby.html">GROUP&#160;BY</a></span>&#160;clause for queries; To recap:
            <div class="fcnWrapperWide"><pre class="FcnSyntax" xml:space="preserve">PARTITION&#160;BY&#160;<span class="ItalicFont">expression</span> [, ...]</pre></div><div class="paramList"><p class="paramName">expression [,...]</p><p class="paramDefnFirst">A list of expressions that define the partitioning.</p></div></p>
                <p class="paramName">orderClause</p>
                <p class="paramDefnFirst">Optional.  Controls the ordering. It is important for ranking functions, since it specifies by which variables ranking is performed. It is also needed for cumulative functions. The syntax for this clause is essentially the same as for the <span class="CodeFont"><a href="sqlref_clauses_orderby.html">SQL&#160;Reference</a>. To recap:
            <div class="fcnWrapperWide"><pre class="FcnSyntax" xml:space="preserve">ORDER&#160;BY expression
   [ ASC&#160;|&#160;DESC&#160;|&#160;USING&#160;<span class="ItalicFont">operator</span> ]<br />   [ NULLS&#160;FIRST |&#160;NULLS&#160;LAST ]
   [, ...]</pre></div><div class="noteNote">The default ordering is ascending (<span class="CodeFont">ASC</span>). For ascending order, <span class="CodeFont">NULL</span>&#160;values are returned last unless you specify <span class="CodeFont">NULLS&#160;FIRST</span>; for descending order, <span class="CodeFont">NULL</span>&#160;values are returned first unless you specify <span class="CodeFont">NULLS&#160;LAST</span>.</div></p>
                <p class="paramName">frameClause</p>
                <p class="paramDefnFirst">Optional. Defines which of the rows (which <span class="ItalicFont">frame</span>) that are passed to the window function should be included in the computation. The <span class="ItalicFont">frameClause</span> provides two offsets that determine the start and end of the frame.</p>
                <p class="paramDefn">The syntax for the frame clause is:
            <div class="fcnWrapperWide"><pre class="FcnSyntax" xml:space="preserve">[RANGE&#160;|&#160;ROWS] <span class="ItalicFont">frameStart</span> |
[RANGE&#160;|&#160;ROWS] BETWEEN&#160;<span class="ItalicFont">frameStart</span> AND&#160;<span class="ItalicFont">frameEnd</span></pre></div></p>
                <p class="paramDefn">The syntax for both <span class="ItalicFont">frameStart</span> and <span class="ItalicFont">frameEnd</span> is:
            <div class="fcnWrapperWide"><pre class="FcnSyntax" xml:space="preserve">UNBOUNDED&#160;PRECEDING |
&lt;n&gt;&#160;PRECEDING       |
CURRENT&#160;ROW&#160;&#160;       |
&lt;n&gt;&#160;FOLLOWING       |
UNBOUNDED&#160;FOLLOWING </pre></div><div class="paramList"><p class="paramName">&lt;n&gt;</p><p class="paramDefnFirst">A a non-negative integer value.</p></div></p>
            </div>
            <p class="heading2">Usage Restrictions</p>
            <p>Because window functions are only allowed in <span class="CodeFont"><a href="sqlref_clauses_using.html">HAVING</a></span>clauses, you sometimes need to use subqueries with window functions to accomplish what seems like it could be done in a simpler query. </p>
            <p>For example, because you cannot use an <span class="CodeFont">OVER</span>&#160;clause in a <span class="CodeFont">WHERE</span>&#160;clause, a query like the following is not possible:</p>
            <div class="preWrapperWide"><pre class="Example" xml:space="preserve">SELECT&#160;*
FROM&#160;Batting
WHERE&#160;rank()&#160;OVER&#160;(PARTITION&#160;BY&#160;"playerID"&#160;ORDER&#160;BY&#160;"G")&#160;= 1;</pre>
            </div>
            <p>And because <span class="CodeFont">WHERE</span> and <span class="CodeFont">HAVING</span>&#160;are computed before the windowing functions, this won't work either:</p>
            <div class="preWrapperWide"><pre class="Example" xml:space="preserve">SELECT&#160;*, rank()&#160;OVER&#160;(PARTITION&#160;BY&#160;"playerID"&#160;ORDER&#160;BY&#160;"G") as rank
FROM&#160;Batting
WHERE&#160;rank&#160;= 1;</pre>
            </div>
            <p>Instead, you need to use a subquery:</p>
            <div class="preWrapperWide"><pre class="Example" xml:space="preserve">SELECT&#160;*
FROM&#160;(
   SELECT&#160;*, rank()&#160;OVER&#160;(PARTITION&#160;BY&#160;"playerID"&#160;ORDER&#160;BY&#160;"G") as rank
   FROM&#160;Batting
)&#160;tmp
WHERE&#160;rank&#160;= 1;</pre>
            </div>
            <p>And note that the above subquery will add a rank column to the original columns,</p>
            <p class="heading2">Simple Window Function Examples</p>
            <p>The examples in this section are fairly simple because they don't use the frame clause.</p>
            <div class="preWrapperWide"><pre class="Example" xml:space="preserve">--- Rank each year within a player by the number of home runs hit by that player
RANK()&#160;OVER&#160;(PARTITION&#160;BY&#160;playerID&#160;ORDER&#160;BY&#160;desc(H));

--- Compute the change in number of games played from one year to the next:
G&#160;- LAG(G)&#160;OVER&#160;(PARTITION&#160;G&#160;playerID&#160;ORDER&#160;BY&#160;yearID);
</pre>
            </div>
            <p class="heading2">Examples with Frame Clauses</p>
            <p>The frame clause can be confusing, given all of the options that it presents. There are three commonly used frame clauses:</p>
            <table summary="Frame clause types">
                <col />
                <col />
                <thead>
                    <tr>
                        <th>Frame Clause Type</th>
                        <th>Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="ItalicFont">Recycled</td>
                        <td class="CodeFont">
                            <p>BETWEEN&#160;UNBOUNDED&#160;PRECEEDING&#160;AND&#160;UNBOUNDED&#160;FOLLOWING</p>
                        </td>
                    </tr>
                    <tr>
                        <td class="ItalicFont">Cumulative</td>
                        <td class="CodeFont">
                            <p>BETWEEN&#160;UNBOUNDED&#160;PRECEEDING&#160;AND&#160;CURRENT&#160;ROW</p>
                        </td>
                    </tr>
                    <tr>
                        <td class="ItalicFont">Rolling</td>
                        <td class="CodeFont">BETWEEN&#160;2 PRECEEDING&#160;AND&#160;2 FOLLOWING</td>
                    </tr>
                </tbody>
            </table>
            <p>Here are some examples of window functions using frame clauses:</p>
            <div class="preWrapperWide"><pre class="Example" xml:space="preserve">--- Compute the running sum of G&#160;for each player:
SUM(G)&#160;OVER&#160;(PARTITION&#160;BY&#160;playerID&#160;ORDER&#160;BY&#160;yearID
  BETWEEN&#160;UNBOUNDED&#160;PRECEEDING&#160;AND&#160;CURRENT&#160;ROW);

--- Compute the career year:
YearID - min(YEARID)&#160;OVER&#160;(PARTITION&#160;BY&#160;playerID
   BETWEEN&#160;UNBOUNDED&#160;PRECEEDING&#160;AND&#160;UNBOUNDED&#160;FOLLOWING)&#160;+ 1;

--- Compute a rolling average of games by player:
MEAN(G)&#160;OVER&#160;(PARTITION&#160;BY&#160;playerID&#160;ORDER&#160;BY&#160;yearID
   BETWEEN&#160;2 PRECEEDING&#160;AND&#160;2 FOLLOWING);
</pre>
            </div>
            <p class="heading2">See Also</p>
            <ul>
                <li><a href="sqlref_builtinfcns_windowfcnsintro.html">Window and Aggregate </a>functions</li>
                <li><a href="sqlref_expressions_select.html"><span class="CodeFont">SELECT</span></a> expression</li>
                <li><a href="sqlref_clauses_having.html"><span class="CodeFont">HAVING</span></a>&#160;clause</li>
                <li><a href="sqlref_clauses_orderby.html"><span class="CodeFont">ORDER BY</span></a>&#160;clause</li>
                <li><a href="sqlref_clauses_where.html"><span class="CodeFont">WHERE</span></a>&#160;clause</li>
                <li>The <a href="developers_fundamentals_windowfcns.html">Using Window Functions</a> section in our <span class="ItalicFont">Splice Machine Developer's Guide</span></li>
            </ul>
        </div>
	</section>
