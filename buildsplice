#!/bin/sh
read -p "Enter the version to build (doc, docstest, docsdev)      [docsdev]: " version
version=${version:-docsdev}

if [ $version = 'doc' ]
then
    read -p "Enter the branch to build (2.7, 2.5)    [2.7]: " branch
branch=${branch:-2.7}
else
    branch='2.7'
fi

echo "Will generate sitemap file: _site/sitemap.$branch.xml"
echo "Will rename sitemap index file sitemapindex.$version,.xml to _site/sitemap.xml"

jekyll build --config=_config.yml,_config_$version.yml,_config_$branch.yml

# When generating a current or test version, we:
#   a. need to move the sitemap generated by jekyll (in _site/sitemapgen.xml) to the name of the branch sitemap
#   b. need to copy the sitemap index file (links to each sitemap) to _site/sitemap.xml

mv _site/sitemapgen.xml _site/sitemap.$branch.xml
cp sitemapindex.$version.xml _site/sitemap.xml
